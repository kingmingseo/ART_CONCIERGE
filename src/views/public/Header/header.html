<nav class="navbar" role="navigation" aria-label="main navigation" style="border-bottom: 1px solid f8f9fa;">
  <div class="navbar-brand">
    <a class="navbar-item logo" href="/">
      ART CONCIERGE
    </a>

    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbarBasicExample">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>

  <div id="navbarBasicExample" class="navbar-menu">
    <div class="navbar-start">
      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          CATEGORY
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item">
            About
          </a>
          <a class="navbar-item">
            Jobs
          </a>
          <a class="navbar-item">
            Contact
          </a>
        </div>
      </div>
    </div>
    <div class="navbar-item">
      <form id="header-search-box" class="pl-4">
        <input id="header-search-input" type="text" placeholder="Search Exhibition">
        <button id="header-search-submit" type="button" onclick="search_Keyword()">
          <i id="header-search-submit-icon" class="fa-solid fa-magnifying-glass"></i>
        </button>
      </form>
    </div>

    <div class="navbar-end">
      <a class="navbar-item" href="/carts">
        CART
      </a>
      <a class="navbar-item" href="/">
        MY PAGE
      </a>
      <a class="navbar-item " href="/auth">
        LOGIN
      </a>
    </div>
  </div>
  </div>
  </div>
</nav>

<script>
  let notLogin_Form = document.getElementById('isNotLogined');
  let login_Form = document.getElementById('isLogined');

  window.onload = function() {
    loadCategory();
    
    // 로그인이 된 경우에만 사용자 정보를 가져오기
    if (localStorage.getItem("loggedIn") === true) {
        showUserInfo();

        notLogin_Form.style.display = 'none';
        login_Form.style.display = 'block';
    }
  };

  // 사용자 정보 가져오기
  function showUserInfo() {

  }

  // 카테고리 목록을 드롭다운 목록에 렌더링
  function loadCategory() {
    axios.get('/api/exhibits/categoryList')
      .then(response => {
        let category_All = response.data;
        console.log(category_All)
        let category_List = [];

        for (let element of category_All) {
          category_List.push(element.category)
        }
      
        category_List.unshift('전체');

        let element_Select = document.querySelector('.navbar-dropdown');
        element_Select.innerHTML = '';

        let for_Count = 1;
        category_List.forEach(category => {
          // 카테고리 최대 5개까지만 목록에 출력
          if (for_Count >= 7) {
            return;
          } else {
            for_Count += 1;
            const createElement = document.createElement("a");
            createElement.className = 'navbar-item';
            createElement.textContent = category;
            createElement.href = `/exhibits?categoryName=${category}`;
            element_Select.appendChild(createElement);
          }
        });
      })
      .catch(error => {
            console.error('에러 발생:', error);
      });
  }

  // 키워드 검색
  function search_Keyword() {
    let input_Element = document.getElementById('header-search-input');

    let keyword = input_Element.value;
    
    if (keyword.trim() === '') {
      alert('검색할 키워드를 입력하세요')
    } else {
      let search_URL = `/exhibits?word=${input_Element.value}`;

      window.location.href = search_URL;
    }
  }

  // 로그아웃
  function logout() {
    alert('로그아웃');
    localStorage.removeItem('loggedIn');
    localStorage.removeItem('isAdmin');
    localStorage.removeItem('jwtToken');

    notLogin_Form.style.display = 'block';
    login_Form.style.display = 'none';
  }

  // 마이페이지를 클릭 시 비로그인, 유저, 관리자에 따라 다르게 연결
  function href_Mypage() {
    let mypage_Element = document.getElementById('mypage_Link');
    // 로그인 O
    if (localStorage.getItem("loggedIn") === true) {
      // 관리자일 경우
      if (localStorage.getItem("isAdmin") === true) {
        window.location.href = '/admin/categories';
        // 유저일 경우
      } else {
        window.location.href = '/users';
      }
      // 로그인 X
    } else {
      alert('로그인이 필요합니다');
      window.location.href ='/auth';
    }
  }
</script>